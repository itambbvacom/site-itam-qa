<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
	<ModulePrefs title="index_incidentes.xml" /> 
	<Content type="html">
		<![CDATA[
				<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
                <style>
						/**********************PERFECT SCROLLBAR**************************/
							.ps-container .ps-scrollbar-x-rail {
								position: absolute; /* please don't change 'position' */
								bottom: 3px; /* there must be 'bottom' for ps-scrollbar-x-rail */
								height: 8px;
								-webkit-border-radius: 4px;
								-moz-border-radius: 4px;
								border-radius: 4px;
								opacity: 0;
								filter: alpha(opacity = 0);
								-o-transition: background-color .2s linear, opacity .2s linear;
								-webkit-transition: background-color.2s linear, opacity .2s linear;
								-moz-transition: background-color .2s linear, opacity .2s linear;
								transition: background-color .2s linear, opacity .2s linear;
							}

							.ps-container:hover .ps-scrollbar-x-rail,
							.ps-container.hover .ps-scrollbar-x-rail {
								opacity: 0.6;
								filter: alpha(opacity = 60);
							}

							.ps-container .ps-scrollbar-x-rail:hover,
							.ps-container .ps-scrollbar-x-rail.hover {
								background-color: #eee;
								opacity: 0.9;
								filter: alpha(opacity = 90);
							}

							.ps-container .ps-scrollbar-x-rail.in-scrolling {
								opacity: 0.9;
								filter: alpha(opacity = 90);
							}

							.ps-container .ps-scrollbar-y-rail {
								position: absolute; /* please don't change 'position' */
								right: 3px; /* there must be 'right' for ps-scrollbar-y-rail */
								width: 8px;
								-webkit-border-radius: 4px;
								-moz-border-radius: 4px;
								border-radius: 4px;
								opacity: 1;
								filter: alpha(opacity = 100);
								-o-transition: background-color .2s linear, opacity .2s linear;
								-webkit-transition: background-color.2s linear, opacity .2s linear;
								-moz-transition: background-color .2s linear, opacity .2s linear;
								transition: background-color .2s linear, opacity .2s linear;
							}

							.ps-container:hover .ps-scrollbar-y-rail,
							.ps-container.hover .ps-scrollbar-y-rail {
								opacity: 1;
								filter: alpha(opacity = 100);
							}

							.ps-container .ps-scrollbar-y-rail:hover,
							.ps-container .ps-scrollbar-y-rail.hover {
								background-color: #eee;
								opacity: 1;
								filter: alpha(opacity = 100);
							}

							.ps-container .ps-scrollbar-y-rail.in-scrolling {
								opacity: 0.9;
								filter: alpha(opacity = 90);
							}

							.ps-container .ps-scrollbar-x {
								position: absolute; /* please don't change 'position' */
								bottom: 0; /* there must be 'bottom' for ps-scrollbar-x */
								height: 8px;
								background-color: #aaa;
								-webkit-border-radius: 4px;
								-moz-border-radius: 4px;
								border-radius: 4px;
								-o-transition: background-color .2s linear;
								-webkit-transition: background-color.2s linear;
								-moz-transition: background-color .2s linear;
								transition: background-color .2s linear;
							}

							.ps-container.ie6 .ps-scrollbar-x {
								font-size: 0; /* fixed scrollbar height in xp sp3 ie6 */
							}

							.ps-container .ps-scrollbar-x-rail:hover .ps-scrollbar-x,
							.ps-container .ps-scrollbar-x-rail.hover .ps-scrollbar-x {
								background-color: #999;
							}

							.ps-container .ps-scrollbar-y {
								position: absolute; /* please don't change 'position' */
								right: 0; /* there must be 'right' for ps-scrollbar-y */
								width: 8px;
								background-color: #aaa;
								-webkit-border-radius: 4px;
								-moz-border-radius: 4px;
								border-radius: 4px;
								-o-transition: background-color .2s linear;
								-webkit-transition: background-color.2s linear;
								-moz-transition: background-color .2s linear;
								transition: background-color .2s linear;
							}

							.ps-container.ie .ps-scrollbar-y {
								font-size: 0; /* fixed scrollbar height in xp sp3 ie6 */
							}

							.ps-container .ps-scrollbar-y-rail:hover .ps-scrollbar-y,
							.ps-container .ps-scrollbar-y-rail.hover .ps-scrollbar-y {
								background-color: #999;
							}

						/*****************************************************************/
						
						/**********************COLORBOX************************************/
							/*
							Colorbox Core Style:
							The following CSS is consistent between example themes and should not be altered.
							*/
							#colorbox, #cboxOverlay, #cboxWrapper{position:absolute; top:0; left:0; z-index:9999; overflow:hidden;}
							#cboxWrapper {max-width:none;}
							#cboxOverlay{position:fixed; width:100%; height:100%;}
							#cboxMiddleLeft, #cboxBottomLeft{clear:left;}
							#cboxContent{position:relative;}
							#cboxLoadedContent{overflow:auto; -webkit-overflow-scrolling: touch;}
							#cboxTitle{margin:0;}
							#cboxLoadingOverlay, #cboxLoadingGraphic{position:absolute; top:0; left:0; width:100%; height:100%;}
							#cboxPrevious, #cboxNext, #cboxClose, #cboxSlideshow{cursor:pointer;}
							.cboxPhoto{float:left; margin:auto; border:0; display:block; max-width:none; -ms-interpolation-mode:bicubic;}
							.cboxIframe{width:100%; height:100%; display:block; border:0;}
							#colorbox, #cboxContent, #cboxLoadedContent{box-sizing:content-box; -moz-box-sizing:content-box; -webkit-box-sizing:content-box;}

							/* 
								User Style:
								Change the following styles to modify the appearance of Colorbox.  They are
								ordered & tabbed in a way that represents the nesting of the generated HTML.
							*/
							#cboxOverlay{background:#000;}
							#colorbox{outline:0;}
							#cboxContent{margin-top:20px;background:#000;}
							.cboxIframe{background:#fff;}
							#cboxError{padding:50px; border:1px solid #ccc;}
							#cboxLoadedContent{border:5px solid #000; background:#fff;}
							#cboxTitle{position:absolute; top:-20px; left:0; color:#ccc;}
							#cboxCurrent{position:absolute; top:-20px; right:0px; color:#ccc;}
							#cboxLoadingGraphic{background:url('https://site-itam.googlecode.com/svn/branches/img/loadingcbx.gif') no-repeat center center;}

							/* these elements are buttons, and may need to have additional styles reset to avoid unwanted base styles */
							#cboxPrevious, #cboxNext, #cboxSlideshow, #cboxClose {border:0; padding:0; margin:0; overflow:visible; width:auto; background:none; }
							
							/* avoid outlines on :active (mouseclick), but preserve outlines on :focus (tabbed navigating) */
							#cboxPrevious:active, #cboxNext:active, #cboxSlideshow:active, #cboxClose:active {outline:0;}
							
							#cboxSlideshow{position:absolute; top:-20px; right:90px; color:#fff;}
							#cboxPrevious{position:absolute; top:50%; left:5px; margin-top:-32px; background:url('https://site-itam.googlecode.com/svn/branches/img/controlscbx.png') no-repeat top left; width:28px; height:65px; text-indent:-9999px;}
							#cboxPrevious:hover{background-position:bottom left;}
							#cboxNext{position:absolute; top:50%; right:5px; margin-top:-32px; background:url('https://site-itam.googlecode.com/svn/branches/img/controlscbx.png') no-repeat top right; width:28px; height:65px; text-indent:-9999px;}
							#cboxNext:hover{background-position:bottom right;}
							#cboxClose{position:absolute; top:5px; right:5px; display:block; background:url('https://site-itam.googlecode.com/svn/branches/img/controlscbx.png') no-repeat top center; width:38px; height:19px; text-indent:-9999px;}
							#cboxClose:hover{background-position:bottom center;}
						/*****************************************************************/
						
                        .header_hide_style {
							display: none;
                        }
                        .header_style {
							height: 35px;
                            background-color: #009EE5;
                            border-right: 0.5px solid #FFFFFF;
                            color: white;
                            font-weight: bold;
                            text-align: center;
                        }
                        .filtros_style {
							color: #094FA4;
                            font-family: Arial, sans-serif;
                            font-weight: bold;
                            font-size: 13px;
                        }
                        .cell_style {
							height: 35px;
                            border-bottom: 1px solid #D9D9D9;
                            background-color: #FFFFFF;
                            text-align: center;
                        }
                        .cell_left_style {
							height: 35px;
                            border-bottom: 1px solid #D9D9D9;
                            background-color: #FFFFFF;
                            text-align: left;
                        }
                        .cell_warning_style {
							height: 35px;
                            border-bottom: 1px solid #D9D9D9;
                            background-color: #dd7e6b;
                            text-align: center;     
                            color: #000000;
                        }
                        .cell_warning_info_style {
							height: 35px;
                            border-bottom: 1px solid #D9D9D9;
                            background-color: #FFD966;
                            text-align: center;     
                            color: #000000;
                        }
                        .cell_style_justify {
							border-bottom: 1px solid #D9D9D9;
                            background-color: #FFFFFF;
                            text-align:justify;
                            white-space: pre-line;
                        }
                        .cell_width_200 {
							width: 300px;
                        }
						.cell_width_180 {
							width: 180px;
                        }
                        .cell_width_120 {
							width: 120px;
                        }
                        .cell_width_100 {
							width: 100px;
                        }
						.cell_width_85 {
							width: 85px;
                        }
						.cell_width_70 {
							width: 70px;
                        }
                        .cell_width_60 {
							width: 60px;
                        }
                        .bold_style {
							font-weight: bold;
                        }
                </style>
                <script type="text/javascript" src="https://www.google.com/jsapi"></script>
                <script src="https://site-itam.googlecode.com/svn/branches/lib/jquery-1.10.2.min.js"></script>
                <script src="https://site-itam.googlecode.com/svn/branches/lib/jquery.mousewheel.js"></script>
                <script src="https://site-itam.googlecode.com/svn/branches/lib/perfect-scrollbar.js"></script>
                <script src="https://site-itam.googlecode.com/svn/branches/lib/jquery.colorbox.js"></script>
                <script type="text/javascript">
                        if(typeof String.prototype.trim !== 'function') {
						  String.prototype.trim = function() {
							return this.replace(/^\s+|\s+$/g, ''); 
						  }
						}                        
                        google.load('visualization', '1.1', {packages: ['controls','table']});
                        google.setOnLoadCallback(draw);

                        function draw() {
							var query = new google.visualization.Query('https://docs.google.com/a/bbva.com/spreadsheet/ccc?key=0AuL8XqqgbAI4dHBYVTRGZEcyVFhuQ2xwM3pIeVpvUlE&usp=drive_web#gid=0');
                            query.send(handleQueryResponse);
                                
                        }
                        
                        function handleQueryResponse(response) {
                                if (response.isError()) {
									alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                                    return;
                                }
                                var data = response.getDataTable();
                                                                
                                var category_reporto = new google.visualization.ControlWrapper({
														'controlType': 'CategoryFilter',
                                                        'containerId': 'filtro1',
                                                        'options': {
															'filterColumnLabel': 'Reportó',
															'ui': {
																'labelSeparator' : '',
                                                                'label' : '',
                                                                'caption' : 'Selecciona',
                                                                'allowMultiple': true,
                                                                'allowTyping': false,
                                                                'selectedValuesLayout': 'aside'
                                                            }
                                                        }
                                                    });
                                
                                var category_area = new google.visualization.ControlWrapper({
														'controlType': 'CategoryFilter',
                                                        'containerId': 'filtro3',
                                                        'options': {
															'filterColumnLabel': 'Área',
                                                            'ui': {
																'labelSeparator' : '',
                                                                'label' : '',
                                                                'caption' : 'Selecciona',
                                                                'allowMultiple': true,
                                                                'allowTyping': false,
                                                                'selectedValuesLayout': 'aside'
                                                            }
                                                        }
                                                    });
                                
                                var category_aplicativo = new google.visualization.ControlWrapper({
														'controlType': 'CategoryFilter',
                                                        'containerId': 'filtro2',
                                                        'options': {
															'filterColumnLabel': 'Aplicativo',
                                                            'ui': {
																'labelSeparator' : '',
                                                                'label' : '',
                                                                'caption' : 'Selecciona',
                                                                'allowMultiple': true,
                                                                'allowTyping': false,
                                                                'selectedValuesLayout': 'aside'
                                                            }
                                                        }
                                                    });
                                
                                var category_estatus = new google.visualization.ControlWrapper({
														'controlType': 'CategoryFilter',
                                                        'containerId': 'filtro4',
                                                        'options': {
															'filterColumnLabel': 'Estatus',
                                                            'ui': {
																'labelSeparator' : '',
                                                                'label' : '',
                                                                'caption' : 'Selecciona',
                                                                'allowMultiple': true,
                                                                'allowTyping': false,
                                                                'selectedValuesLayout': 'aside'
															}
                                                        }
                                                    });
                                                                
                                var cssClassNames = {
									'headerRow': 'header_hide_style',
                                    'tableCell': 'cell_style'
                                };
                                
                                var options = {'allowHtml': true, 'cssClassNames': cssClassNames, 'sort': 'disable', 'height': '100%', 'width': '100%'};
                                
                                var table = new google.visualization.ChartWrapper({
												'chartType': 'Table',
                                                'containerId': 'table',
                                                'options': options
                                                });

								var formatter_link = new google.visualization.PatternFormat('<a class="inline" href="#inline_content" onclick="getComentario(this);"><input type="hidden" value="{8}"/>{0}</a>');
                                formatter_link.format(data, [0, 1, 2, 3, 4, 5, 6, 7, 8]);
								
                                var formatter_fecha_reporte = new google.visualization.DateFormat({pattern: 'dd.LLLyy'});
                                formatter_fecha_reporte.format(data, 3);
								var formatter_fecha_compromiso = new google.visualization.DateFormat({pattern: 'dd.LLLyy'});
                                formatter_fecha_compromiso.format(data, 5);
                                
                                var column_reporto = 0;
                                var column_aplicativo = 1;
                                var column_area = 2;
                                var column_fechareporte = 3;
                                var column_estatus = 4;
                                var column_fechacompromiso = 5;
                                var column_incidencia = 6;
                                var column_responsable = 7;

                                for (var row = 0; row < data.getNumberOfRows(); row++) {
									data.setCell(row, column_reporto, data.getValue(row, column_reporto), data.getFormattedValue(row, column_reporto), {'className': 'cell_left_style cell_width_100'});
                                    data.setCell(row, column_aplicativo, data.getValue(row, column_aplicativo), data.getFormattedValue(row, column_aplicativo), {'className': 'cell_style bold_style cell_width_120'});
                                    data.setCell(row, column_area, data.getValue(row, column_area), data.getFormattedValue(row, column_area), {'className': 'cell_style bold_style cell_width_120'});
                                                                        
                                    data.setCell(row, column_fechareporte, data.getValue(row, column_fechareporte), data.getFormattedValue(row, column_fechareporte), {'className': 'cell_style bold_style cell_width_85'});
                                    data.setCell(row, column_estatus, data.getValue(row, column_estatus), data.getFormattedValue(row, column_estatus), {'className': 'cell_style cell_width_60'});
                                    
									data.setCell(row, column_fechacompromiso, data.getValue(row, column_fechacompromiso), data.getFormattedValue(row, column_fechacompromiso), {'className': 'cell_style bold_style cell_width_85'});
                                    
									         
                                    data.setCell(row, column_incidencia, data.getValue(row, column_incidencia), data.getFormattedValue(row, column_incidencia), {'className': 'cell_style_justify'});
                                    data.setCell(row, column_responsable, data.getValue(row, column_responsable), data.getFormattedValue(row, column_responsable), {'className': 'cell_style cell_width_100'});                                                                        
                                }
                                
                                var view = new google.visualization.DataView(data);
                                view.setColumns([0, 1, 2, 3, 4, 5, 6, 7]);
                                
                                new google.visualization.Dashboard(document.getElementById('dashboard')).
                                                bind([category_reporto, category_area, category_aplicativo, category_estatus], table).
                                                draw(view);

                                google.visualization.events.addListener(table, 'ready',
                                        function(event) {
												 $(".inline").colorbox({inline:true, width:"40%", height:"40%"});
                                                $('#contenido_tabla').perfectScrollbar({
													wheelSpeed: 20,
													wheelPropagation: false
                                                });
                                                
                                                $("#table table tbody tr:last-child td").each(function(index){
													if ($("#w"+(index+1)).val() > $(this).width()) {
														$(this).width($("#w"+(index+1)).val());
                                                        $("#h"+(index+1)).width($("#w"+(index+1)).val());
                                                    } else {
														$("#h"+(index+1)).width($(this).width());
                                                    }

                                                });
                                                $("#table table tbody tr:last-child td").each(function(index){
													$("#h"+(index+1)).width($(this).width());
                                                });
                                                
                                                
                                });
                                
                        }
                        function getComentario(elemento) {
							$("#comentario_text").text(elemento.firstChild.value);
						}
						function seleccionar(el) {
							var body = document.body, range, sel;
							if (document.createRange && window.getSelection) {
								range = document.createRange();
                                sel = window.getSelection();
                                sel.removeAllRanges();
                                try {
									range.selectNodeContents(el);
                                    sel.addRange(range);
                                    range.execCommand('copy');
                                } catch (e) {
                                    range.selectNode(el);
                                    sel.addRange(range);
                                }
                            } else if (body.createTextRange) {
								range = body.createTextRange();
                                range.moveToElementText(el);
                                range.select();
                            }
                        }
                </script>
                <div id="dashboard">
					<table width="100%">
						<tr>
							<td colspan="8" style="text-align:right;">
								<a href="#" onclick="seleccionar(document.getElementById('select_table'));">
									<img src="https://site-itam.googlecode.com/svn/branches/img/btnSelecciona2.png">
								</a>
							</td>
						</tr>
						<tr>
							<td width="5%" height="50px" style="text-align:right;" class="filtros_style">Reportó:</td>
							<td width="28%" height="50px" class="filtros_style"><div id="filtro1"></div></td>
							<td width="8%" height="50px" style="text-align:right;" class="filtros_style">Aplicativo:</td>
							<td width="13%" height="50px" class="filtros_style"><div id="filtro2"></div></td>
							<td width="5%" height="50px" style="text-align:right;" class="filtros_style">Área:</td>
							<td width="18%" height="50px" class="filtros_style"><div id="filtro3"></div></td>
							<td width="5%" height="50px" style="text-align:right;" class="filtros_style">Estatus:</td>
							<td width="18%" height="50px" class="filtros_style"><div id="filtro4"></div></td>
						</tr>
						<tr>
							<td colspan="8">
								<div id="select_table">
									<table id="headers_table"  width="100%" height="35px" class="filtros_style">
										<tr>
											<td id="h1" class="header_style"><input id="w1" type="hidden" value="131"/>Reportó</td>
											<td id="h2" class="header_style"><input id="w2" type="hidden" value="101"/>Aplicativo</td>
											<td id="h3" class="header_style"><input id="w3" type="hidden" value="90"/>Área</td>
											<td id="h4" class="header_style"><input id="w4" type="hidden" value="60"/>Fecha Reporte</td>
											<td id="h5" class="header_style"><input id="w5" type="hidden" value="55"/>Estatus</td>
											<td id="h6" class="header_style"><input id="w6" type="hidden" value="60"/>Fecha Compromiso</td>
											<td id="h7" class="header_style"><input id="w7" type="hidden" value="180"/>Incidencia</td>
											<td id="h8" class="header_style"><input id="w8" type="hidden" value="131"/>Responsable</td>
										</tr>
									</table>
									<div id="contenido_tabla" style="height:500px;overflow:hidden;position:relative;">
										<table width="100%">
											<tr>
												<td><div id="table"></div></td>
											</tr>
										</table>
									</div>
								</div>
							</td>
						</tr>
					</table>
					
                </div>
				<div style="display:none">
					<div id="inline_content" style="padding:10px; background:#fff;">
						<table width="100%" height="92%"  class="filtros_style">
							<tr>
								<td class="header_style">Comentarios</td>
							</tr>
							<tr>
								<td id="comentario_text" class="cell_style_justify"></td>
							</tr>
						</table>
						
					</div>
				</div>
		]]>
	</Content> 
</Module>