<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="index_news.xml" /> 
  <Content type="html">
        <![CDATA[
                <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
                <style>
                        div {
                                font-family: Arial, sans-serif;
                                background-color: #ffffff;
                                font-variant: middle;
                        }        
                        /*
                                Slideshow
                        */
                        #slides {
                                z-index: 100;
                        }
                        /*
                                Slides container
                                Important:
                                Set the width of your slides container
                                Set to display none, prevents content flash
                        */
                        .slides_container {
                                height: 300px;
                                overflow: hidden;
                                display: none;
                                margin: 0 auto;
                        }
                                 
                        /*
                                Each slide
                                Important:
                                Set the width of your slides
                                If height not specified height will be set by the slide content
                                Set to display block
                        */
                        .slides_container div.slide {
                                display: block;
                                height: 300px;
                        }
                        
                        /*
                                Next/prev buttons
                        */
                        #slides .next,#slides .prev {
                                position: absolute;
                                top: 160px;
                                left: 3px;
                                width: 24px;
                                height: 43px;
                                display: block;
                                z-index: 101;
                                opacity: 0.5;
                        }        
                        
                        #slides .next {
                                left: 510px;
                        }
                                 
                        /*
                                Pagination
                        */
                        .pagination {
                                margin: 0px auto 0;
                                width: 100px;
                        }
                                 
                        .pagination li {
                                float: left;
                                margin: 0 1px;
                                list-style: none;
                        }
                                 
                        .pagination li a {
                                display: block;
                                width: 12px;
                                height: 0;
                                padding-top: 12px;
                                background-position: 0 0;
                                float: left;
                                overflow: hidden;
                        }
                                 
                        .pagination li.current a {
                                background-position: 0 -12px;
                        }
                                 
                        a:link,a:visited {
                                color: #599100;
                                text-decoration: none;
                        }
                                 
                        a:hover,a:active {
                                color: #599100;
                                text-decoration: underline;
                        }
                                 
                        span.newsTitle {
                                font-size: 18px;
                                text-transform: uppercase;
                                font-weight: bold;
                                border-bottom: 1px solid #b0f0d8;
                        }
                        #fondo {
                                float:left;
                                position:relative;
                        }
                        #fondo .informacion {
                                width:320px;
                                position:absolute;
                                top:10px;
                                left:14px;
                        }
                </style>
                <script type="text/javascript" src="https://www.google.com/jsapi"></script>
                <script src="https://site-itam.googlecode.com/svn/branches/lib/jquery-1.10.2.min.js"></script>
                <script src="https://site-itam.googlecode.com/svn/branches/lib/slides.min.jquery.js"></script>
                <script type="text/javascript">
                        google.load('visualization', '1.1', {packages: ['controls']});
                        google.setOnLoadCallback(draw);
                        
                        function draw() {
                                                                var w = $('#slides').width();
                                                                $('.slides_container div.slide').width(w);
                                                                $('.contenido').width(w*0.85);
                                                                
                                                                w = $('.slide').width() - ((w*0.85) + 10);
                                                                w = w/2;
                                                                w = w - 20;
                                                                $('#slides .prev').css('left', w);
                                                                w = $('.slide').width() - w - 10;
                                                                $('#slides .next').css('left', w);

                                var query = new google.visualization.Query('https://docs.google.com/a/bbva.com/spreadsheet/ccc?key=1nb9ogvBm4aA3n1bYwSszZ3EbjZu76QrkWudNJNIe7Ko&usp=drive_web#gid=0');
                                query.send(handleQueryResponse);
                        }
                        
                        function handleQueryResponse(response) {
                                if (response.isError()) {
                                        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                                        return;
                                }
                        
                                var data = response.getDataTable();
								var html_content, html_content_temp, index;
								
                                for (var row = 0; row < data.getNumberOfRows(); row++) {
										html_content_temp = data.getValue(row, 2);
										html_content_temp = removespansfonts(html_content_temp);
										index = html_content_temp.indexOf('<td');
										index = html_content_temp.indexOf('>', index);
										html_content = html_content_temp.slice(0, index + 1);
										html_content = html_content + '<h5 style="color:#094FA4;margin:0;">';
										html_content = html_content + html_content_temp.slice(index + 1);
										html_content_temp = html_content;
										index = html_content_temp.lastIndexOf('</td>');
										html_content = html_content_temp.slice(0, index);
										html_content = html_content + '</h5>';
										html_content = html_content + html_content_temp.slice(index);

                                        $('#f' + (row + 1)).text('Fecha: ' + data.getFormattedValue(row, 0));
                                        $('#h' + (row + 1)).text(cut_text(data.getValue(row, 1), 43));
										$('#c' + (row + 1)).append(html_content);
                                        $('#a' + (row + 1)).text('Autor: ' + data.getValue(row, 3));
                                        $('#l' + (row + 1)).attr('href', data.getValue(row, 4));
                                }
                                
                                slide_news();
                        
                        }
                        function removespansfonts(html_text) {
							var index_class = html_text.indexOf("<span");
							var html_res;
							while (index_class != -1) {
								html_res = html_text.slice(0, index_class);
								index_class = html_text.indexOf(">", index_class + 5);
								html_res =  html_res + html_text.slice(index_class + 1);
								html_text = html_res;
								index_class = html_text.indexOf("<span");
							}
							index_class = html_text.indexOf("</span");
							while (index_class != -1) {
								html_res = html_text.slice(0, index_class);
								index_class = html_text.indexOf(">", index_class + 6);
								html_res =  html_res + html_text.slice(index_class + 1);
								html_text = html_res;
								index_class = html_text.indexOf("</span");
							}
							
							index_class = html_text.indexOf("<font");
							while (index_class != -1) {
								html_res = html_text.slice(0, index_class);
								index_class = html_text.indexOf(">", index_class + 5);
								html_res =  html_res + html_text.slice(index_class + 1);
								html_text = html_res;
								index_class = html_text.indexOf("<font");
							}
							
							index_class = html_text.indexOf("</font");
							while (index_class != -1) {
								html_res = html_text.slice(0, index_class);
								index_class = html_text.indexOf(">", index_class + 6);
								html_res =  html_res + html_text.slice(index_class + 1);
								html_text = html_res;
								index_class = html_text.indexOf("</font");
							}
							//
						
							return html_text;
							
						}
                        function cut_text(text, size) {
                                if (text.length > size) {
                                   text = text.substring(0, size);
                                   var index = text.lastIndexOf(' ');
                                   if (index != -1) {
                                           text = text.substring(0, (index + 1));
                                   }
                                   text = text.trim();
                                   text = text + '...';
                                }
                                
                                return text;
                        }
                        
                        function slide_news() {
                                $('#slides').slides({
                                        preload : true,
                                        preloadImage : 'https://site-itam.googlecode.com/svn/branches/img/loading.gif',
                                        play : 7000, //7000
                                        pause : 3500,//3500
                                        hoverPause : true,
                                        animationStart : function(current) {
                                        },
                                        animationComplete : function(current) {
                                        },
                                        slidesLoaded : function() {
                                        }
                                });
                                
                                $('.pagination li a').css('background-image', 'url(https://site-itam.googlecode.com/svn/branches/img/pagination.png)');
                        }
                </script>
                <div id="slides">
                        <div class="slides_container">
                                <div class="slide">
										<a id="l1" href="#" target="_blank">
                                        <table style="margin:auto;">
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido"><h6 id="f1" style="color:#094FA4;margin:10;" align="right"></h6>
																			  <h6 id="a1" style="color:#094FA4;margin:0;" align="right"></h6></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" style="border-bottom:2px solid #094FA4;"><h3 id="h1" style="color:#094FA4; margin-bottom:2px;"></h3></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" height="180" style="vertical-align:top;"><div id="c1"></div></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <!--tr>
                                                        <td width="5"></td>
                                                        <td class="contenido">
                                                                                                                                </br>
                                                                <h6 id="a1" style="color:#094FA4;margin:0;" align="center"></h6>
                                                                <a id="l1" href="#" target="_blank"><h6 style="color:#094FA4;margin:0;" align="left">Leer mas...</h6></a>
                                                        </td>
                                                        <td width="5"></td>
                                                </tr-->
                                        </table>
										</a>
                                </div>
                                <div class="slide">
										<a id="l2" href="#" target="_blank">
                                        <table style="margin:auto;">
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido"><h6 id="f2" style="color:#094FA4;margin:10;" align="right"></h6>
																			  <h6 id="a2" style="color:#094FA4;margin:0;" align="right"></h6></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" style="border-bottom:2px solid #094FA4;"><h3 id="h2" style="color:#094FA4; margin-bottom:2px;"></h3></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" height="180" style="vertical-align:top;"><div id="c2"></div></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <!--tr>
                                                        <td width="5"></td>
                                                        <td class="contenido">
                                                                                                                                </br>
                                                                <h6 id="a2" style="color:#094FA4;margin:0;" align="center"></h6>
                                                                <a id="l2" href="#" target="_blank"><h6 style="color:#094FA4;margin:0;" align="left">Leer mas...</h6></a>
                                                        </td>
                                                        <td width="5"></td>
                                                </tr-->
                                        </table>
										</a>
                                </div>
                                <div class="slide">
										<a id="l3" href="#" target="_blank">
                                        <table style="margin:auto;">
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido"><h6 id="f3" style="color:#094FA4;margin:10;" align="right"></h6>
																			  <h6 id="a3" style="color:#094FA4;margin:0;" align="right"></h6></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" style="border-bottom:2px solid #094FA4;"><h3 id="h3" style="color:#094FA4; margin-bottom:2px;"></h3></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" height="180" style="vertical-align:top;"><div id="c3"></div></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <!--tr>
                                                        <td width="5"></td>
                                                        <td class="contenido">
                                                                                                                                </br>
                                                                <h6 id="a3" style="color:#094FA4;margin:0;" align="center"></h6>
                                                                <a id="l3" href="#" target="_blank"><h6 style="color:#094FA4;margin:0;" align="left">Leer mas...</h6></a>
                                                        </td>
                                                        <td width="5"></td>
                                                </tr-->
                                        </table>
										</a>
                                </div>
                                <div class="slide">
										<a id="l4" href="#" target="_blank">
                                        <table style="margin:auto;">
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido"><h6 id="f4" style="color:#094FA4;margin:10;" align="right"></h6>
																			  <h6 id="a4" style="color:#094FA4;margin:0;" align="right"></h6></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" style="border-bottom:2px solid #094FA4;"><h3 id="h4" style="color:#094FA4; margin-bottom:2px;"></h3></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <tr>
                                                        <td width="5"></td>
                                                        <td class="contenido" height="180" style="vertical-align:top;"><div id="c4"></div></td>
                                                        <td width="5"></td>
                                                </tr>
                                                <!--tr>
                                                        <td width="5"></td>
                                                        <td class="contenido">
                                                                                                                                </br>
                                                                <h6 id="a4" style="color:#094FA4;margin:0;" align="center"></h6>
                                                                <a id="l4" href="#" target="_blank"><h6 style="color:#094FA4;margin:0;" align="left">Leer mas...</h6></a>
                                                        </td>
                                                        <td width="5"></td>
                                                </tr-->
                                        </table>
										</a>
                                </div>
                        </div>
                        <a href="#" class="prev">
                                <img src="https://site-itam.googlecode.com/svn/branches/img/arrow-prev.png" width="24" height="43" alt="Arrow Prev">
                        </a>
                        <a href="#" class="next">
                                <img src="https://site-itam.googlecode.com/svn/branches/img/arrow-next.png" width="24" height="43" alt="Arrow Next">
                        </a>
                </div>

        ]]>
  </Content> 
</Module>